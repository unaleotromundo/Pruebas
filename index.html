<!DOCTYPE html>
<html lang="es" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PaseoDog - Sistema Mejorado</title>
    <!-- FAVICON -->
    <link rel="icon" type="image/svg+xml" href="paseodog-logo.svg">
    <link rel="manifest" href="manifest.json">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="PaseoDog">
    <link rel="apple-touch-icon" href="paseodog-logo.svg">
    <!-- ESTILOS -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- FONDO DE PARTÃCULAS -->
    <div id="particles-container"></div>
    <!-- TOAST NOTIFICATIONS -->
    <div id="toast-container"></div>
    <!-- LOADING -->
    <div id="loading-overlay">
        <div class="spinner"></div>
        <p>Cargando base de datos...</p>
    </div>
    <!-- BOTONES FLOTANTES -->
    <a href="#" id="whatsapp-btn" class="whatsapp-float" target="_blank" style="display:none;">
        <svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 24 24" fill="currentColor">
            <path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372-.272.297-1.04 1.017-1.04 2.481 0 1.461 1.063 2.875 1.211 3.074.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.626.712.226 1.36.194 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"/>
        </svg>
    </a>
    <button id="audio-toggle" class="audio-float" title="Silenciar sonido">ğŸ”Š</button>
    <header>
        <button id="theme-toggle" title="Cambiar Tema">ğŸ©</button>
        <h1>ğŸ¾ PaseoDog</h1>
        <p id="saludo-usuario">GestiÃ³n Profesional de Paseos</p>
    </header>
    <main id="app-container">
        <!-- LOGIN -->
        <section id="login-section">
            <h2>ğŸ” Acceso al Sistema</h2>
            <form id="login-form">
                <label>Correo ElectrÃ³nico</label>
                <input type="email" id="email" placeholder="ejemplo@paseos.com" required>
                <label>ContraseÃ±a</label>
                <div class="password-wrapper">
                    <input type="password" id="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required>
                    <button type="button" class="password-toggle" id="toggle-password">ğŸ‘ï¸</button>
                </div>
                <button type="submit">Iniciar SesiÃ³n</button>
                <p id="error-message" class="error" style="display:none;"></p>
                <div class="info-text" style="margin-top: 20px;">
                    <strong>ğŸ”‘ Credenciales de prueba:</strong><br><br>
                    ğŸ‘¨â€ğŸ’¼ <strong>Admin:</strong> <code>admin@paseos.com</code> / <code>admin123</code><br><br>
                    ğŸ‘¤ <strong>Clientes (pass: 123456):</strong><br>
                    â€¢ <code>cliente@paseos.com</code> (Fido)<br>
                    â€¢ <code>luna@paseos.com</code> (Luna)<br>
                    â€¢ <code>max@paseos.com</code> (Max)
                </div>
                <button type="button" id="toggle-demo-btn" style="background: var(--warning); margin-top: 16px;">
                    ğŸ“¥ Cargar Datos de Ejemplo
                </button>
                <p id="demo-status" style="text-align: center; margin-top: 12px; color: var(--text-secondary); font-size: 0.9rem;">
                    Estado: <strong id="demo-status-text">Base de datos cargada</strong>
                </p>
            </form>
        </section>
        <!-- ADMIN DASHBOARD -->
        <section id="admin-dashboard-section" style="display:none;">
            <h2>ğŸ‘¨â€ğŸ’¼ Panel de Administrador</h2>
            <button class="add-dog-btn ripple" onclick="showView('create-dog-section')" style="margin-bottom:20px; font-size:1.1rem; padding:15px;">â• Registrar Nuevo Mimoso</button>
            <p style="color: var(--text-secondary); margin-bottom: 24px;">Lista de perros registrados:</p>
            <div id="dog-list-container"></div>
        </section>
        <!-- CREATE DOG -->
        <section id="create-dog-section" style="display:none;">
            <h2>ğŸ¶ Registrar Nuevo Mimoso</h2>
            <form id="create-dog-form">
                <h3>Datos del Perro</h3>
                <label>Nombre</label><input type="text" id="new-dog-name" required>
                <label>Raza</label><input type="text" id="new-dog-breed" required>
                <label>Sexo</label><select id="new-dog-sex"><option>Macho</option><option>Hembra</option></select>
                <h3>Datos del DueÃ±o</h3>
                <label>Nombre DueÃ±o</label><input type="text" id="new-dog-owner" required>
                <label>Email (Usuario)</label><input type="email" id="new-dog-email" required>
                <label>TelÃ©fono (WhatsApp)</label><input type="tel" id="new-dog-phone" required>
                <button type="submit" id="save-dog-btn" class="save-btn ripple">ğŸ’¾ Guardar en Base de Datos</button>
            </form>
            <button class="nav-button ripple" onclick="goBack()" style="background:var(--text-secondary);">Cancelar</button>
        </section>
        <!-- DOG DASHBOARD -->
        <section id="dog-selection-dashboard" style="display:none;">
            <h2>ğŸ• Dashboard de <span class="dog-name-placeholder"></span></h2>
            <div id="carousel-wrapper" style="display:none;">
                <div id="carousel-container">
                    <img id="carousel-img" src="" alt="Diapositiva">
                    <button id="carousel-play-large" class="carousel-play-large" onclick="togglePlay()" style="display:none;">â–¶</button>
                    <div class="carousel-nav">
                        <button class="carousel-nav-btn" id="prev-btn" onclick="prevSlide()">â€¹</button>
                        <button class="carousel-nav-btn" id="next-btn" onclick="nextSlide()">â€º</button>
                    </div>
                    <div class="carousel-controls">
                        <span id="carousel-counter"></span>
                        <div class="carousel-actions">
                            <button class="carousel-action-btn" id="play-pause-btn" onclick="togglePlay()">â–¶</button>
                            <button class="carousel-action-btn" onclick="toggleFullscreen()">â›¶</button>
                        </div>
                    </div>
                </div>
            </div>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 24px;">
                <button id="admin-create-walk-btn" class="admin-action-button ripple" style="display:none;" onclick="showView('create-walk-section')">
                    â• Crear Nuevo Paseo
                </button>
                <button class="nav-button ripple" onclick="showView('walks-history-section')">
                    ğŸ“œ Historial de Paseos
                </button>
                <button class="nav-button ripple" onclick="showView('profile-section')">
                    ğŸ“‹ Ver/Editar Perfil
                </button>
            </div>
            <button class="nav-button ripple" onclick="goBack()" style="background: var(--text-secondary); margin-top: 16px;">
                â¬…ï¸ Volver
            </button>
        </section>
        <!-- CREATE WALK -->
        <section id="create-walk-section" style="display:none;">
            <h2>â• Crear Nuevo Paseo</h2>
            <form id="walk-form">
                <div style="background: var(--bg-input); padding: 15px; border-radius: var(--radius); border: 1px solid var(--border); margin-bottom: 20px;">
                    <label style="color: var(--secondary);">ğŸ¶ Â¿QuiÃ©n mÃ¡s vino al paseo?</label>
                    <div id="multi-dog-container"></div>
                </div>
                <label>ğŸ“… Fecha</label><input type="date" id="walk-date" required>
                <label>â±ï¸ DuraciÃ³n (min)</label><input type="number" id="walk-duration" value="60" required>
                <label>ğŸ“ Distancia (km)</label><input type="number" id="walk-distance" step="0.1" value="3.5">
                <label>ğŸ“ Resumen</label><textarea id="walk-summary" required></textarea>
                <div class="checkbox-group">
                    <input type="checkbox" id="comportamiento-problemas">
                    <label>âš ï¸ Problemas de comportamiento</label>
                </div>
                <label>ğŸ©º Notas de Salud</label><textarea id="incidentes-salud"></textarea>
                <h3>ğŸ“¸ Fotos del Paseo</h3>
                <div id="photo-preview" style="display:flex; gap:10px; margin-bottom:15px; flex-wrap:wrap;"></div>
                <button type="button" id="simulate-photos-btn" class="nav-button ripple" style="background: var(--secondary);">ğŸ“· Simular Fotos</button>
                <button type="submit" class="save-btn ripple">ğŸ’¾ Guardar Paseo</button>
            </form>
            <button class="nav-button ripple" onclick="goBack()" style="background: var(--text-secondary);">Cancelar</button>
        </section>
        <!-- PROFILE -->
        <section id="profile-section" style="display:none;">
            <h2>ğŸ“‹ Perfil Completo</h2>
            <div id="profile-content">
                <div id="profile-photo-container">
                    <img id="profile-photo" src="" alt="Foto del Perro">
                    <p id="profile-dog-name-display" class="dog-name-placeholder" style="font-size:1.5rem; font-weight:bold; color:var(--primary); margin-top:10px;"></p>
                    <button id="edit-photo-btn" class="edit-btn ripple" style="display:none; margin: 10px auto;" onclick="randomizeProfilePhoto()">ğŸ² Cambiar Foto</button>
                    <button id="toggle-edit-btn" class="edit-btn ripple" style="background: var(--secondary); margin-top: 16px;" onclick="toggleEditMode()">âœï¸ Editar Perfil</button>
                </div>
                <div id="profile-details-view"></div>
            </div>
            <button class="nav-button ripple" onclick="goBack()" style="background: var(--text-secondary); margin-top: 24px;">â¬…ï¸ Volver</button>
        </section>
        <!-- HISTORY -->
        <section id="walks-history-section" style="display:none;">
            <h2>ğŸ“œ Historial de Paseos</h2>
            <div id="walks-history"></div>
            <button class="nav-button ripple" onclick="goBack()" style="background: var(--text-secondary); margin-top: 16px;">â¬…ï¸ Volver</button>
        </section>
    </main>
    <!-- LIGHTBOX -->
    <div id="lightbox">
        <span class="lightbox-close" id="close-lightbox">&times;</span>
        <img id="lightbox-img" src="">
    </div>
    <!-- MODAL EDIT WALK -->
    <div id="edit-walk-modal" style="display:none;">
        <div class="modal-content">
            <h2>âœï¸ Editar Paseo</h2>
            <form id="edit-walk-form">
                <label>Fecha</label><input type="date" id="edit-walk-date">
                <label>DuraciÃ³n (min)</label><input type="number" id="edit-walk-duration">
                <label>Distancia (km)</label><input type="number" id="edit-walk-distance" step="0.1">
                <label>Resumen</label><textarea id="edit-walk-summary"></textarea>
                <div class="checkbox-group">
                    <input type="checkbox" id="edit-walk-behavior">
                    <label>Problemas de comportamiento</label>
                </div>
                <label>Notas de Salud</label><textarea id="edit-walk-health"></textarea>
                <h3>Gestionar Fotos</h3>
                <div id="edit-photo-preview" style="display:flex; gap:10px; flex-wrap:wrap; margin:10px 0;"></div>
                <button type="button" onclick="addPhotoEdit()" class="edit-btn ripple" style="background:var(--secondary); width:100%; margin-bottom:15px;">â• Agregar Foto</button>
                <div style="display:flex; gap:10px;">
                    <button type="submit" class="save-btn ripple">ğŸ’¾ Guardar Cambios</button>
                    <button type="button" class="nav-button ripple" onclick="document.getElementById('edit-walk-modal').style.display='none'" style="background:var(--text-secondary);">Cancelar</button>
                </div>
            </form>
        </div>
    </div>
    <!-- INPUT OCULTO PARA SUBIR FOTOS -->
    <input type="file" id="photo-upload-input" accept="image/*" style="display:none;">
    <!-- SUPABASE SDK (CORREGIDO: sin espacios al final) -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- SCRIPT -->
    <script src="script.js"></script>
</body>
</html>